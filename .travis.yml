sudo: required
dist: trusty
language: python
python:
    - "2.7"
virtualenv:
    system_site_packages: true
cache:
    - apt: true
    - pip: true
before_install:
    - export ROS_DISTRO=indigo
    - export ROS_CI_DESKTOP=`lsb_release -cs`
    - export ROS_MASTER_URI=http://localhost:11311
install:
    # Install ROS
    - sudo sh -c 'echo "deb http://packages.ros.org/ros/ubuntu `lsb_release -sc` main" > /etc/apt/sources.list.d/ros-latest.list'
    - wget http://packages.ros.org/ros.key -O - | sudo apt-key add -
    - sudo apt-get update -qq
    - sudo apt-get install -qq -y python-catkin-pkg python-catkin-tools python-rosdep python-wstool ros-$ROS_DISTRO-catkin ros-$ROS_DISTRO-ros lcov
    - gem install coveralls-lcov
    - source /opt/ros/$ROS_DISTRO/setup.bash
    # Setup rosdep
    - sudo rosdep init
    - rosdep update
    # Create workspace.
    - mkdir -p ~/catkin_ws/src
    - cd ..; mv stf ~/catkin_ws/src
    - cd ~/catkin_ws
    - catkin init
    - rosdep install --from-paths src --ignore-src --rosdistro=${ROS_DISTRO} -y
script:
    - catkin build
    - catkin run_tests stf --no-deps
    - catkin_test_results build/stf
